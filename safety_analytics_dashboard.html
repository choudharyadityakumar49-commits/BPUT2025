<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Safety Analytics Dashboard - HO Safety Management</title>
    <link rel="stylesheet" href="../css/main.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <script type="module" src="https://static.rocket.new/rocket-web.js?_cfg=https%3A%2F%2Fhosafety6270back.builtwithrocket.new&_be=https%3A%2F%2Fapplication.rocket.new&_v=0.1.9"></script>
  <script type="module" src="https://static.rocket.new/rocket-shot.js?v=0.0.1"></script>
  </head>
<body class="bg-background min-h-screen">
    <!-- Fixed Header -->
    <header class="bg-surface shadow-sm border-b border-border fixed top-0 left-0 right-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <!-- Logo and Title -->
                <div class="flex items-center space-x-3">
                    <div class="flex-shrink-0">
                        <svg class="h-8 w-8 text-primary" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-xl font-semibold text-text-primary">HO Safety Management</h1>
                        <p class="text-sm text-text-secondary">Analytics Dashboard</p>
                    </div>
                </div>

                <!-- Header Actions -->
                <div class="flex items-center space-x-4">
                    <!-- Export Actions -->
                    <div class="hidden md:flex items-center space-x-2">
                        <button onclick="exportData('pdf')" 
                                class="btn-secondary text-sm px-3 py-2" title="Export PDF (Ctrl+P)">
                            <svg class="w-4 h-4 mr-1 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                            </svg>
                            Export
                        </button>
                        <button onclick="window.location.href='safety_reports_management.html'" 
                                class="btn-primary text-sm px-3 py-2" title="View Reports (Ctrl+R)">
                            <svg class="w-4 h-4 mr-1 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                            </svg>
                            Reports
                        </button>
                    </div>

                    <!-- Sync Status -->
                    <div class="flex items-center space-x-2 text-sm text-success">
                        <div class="w-2 h-2 bg-success rounded-full animate-pulse"></div>
                        <span class="hidden sm:inline">Live sync</span>
                    </div>

                    <!-- User Profile -->
                    <div class="flex items-center space-x-2">
                        <div class="hidden sm:block text-right">
                            <p class="text-sm font-medium text-text-primary">Sarah Johnson</p>
                            <p class="text-xs text-text-secondary">Safety Manager</p>
                        </div>
                        <img src="https://images.unsplash.com/photo-1592831383329-23d79a212006" 
                             alt="Sarah Johnson profile picture" 
                             class="h-8 w-8 rounded-full object-cover"
                             onerror="this.src='https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; this.onerror=null;">
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="pt-16 pb-20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <!-- Page Header -->
            <div class="flex flex-col lg:flex-row lg:items-center justify-between mb-6">
                <div>
                    <h2 class="text-2xl font-semibold text-text-primary">Safety Analytics Dashboard</h2>
                    <p class="text-text-secondary mt-1">Data-driven insights for strategic safety management</p>
                </div>
                <div class="flex items-center space-x-2 mt-4 lg:mt-0">
                    <span class="text-sm text-text-secondary">Last updated:</span>
                    <span class="text-sm font-medium text-text-primary">Oct 21, 2025 2:05 PM</span>
                    <div class="w-2 h-2 bg-success rounded-full ml-2"></div>
                </div>
            </div>

            <!-- Desktop Layout -->
            <div class="hidden lg:grid lg:grid-cols-5 gap-6">
                <!-- Filter Panel (20%) -->
                <div class="lg:col-span-1">
                    <div class="card p-6 sticky top-20">
                        <h3 class="text-lg font-semibold text-text-primary mb-4">Filters & Controls</h3>
                        
                        <!-- Date Range -->
                        <div class="mb-6">
                            <label class="block text-sm font-medium text-text-primary mb-2">Date Range</label>
                            <select id="dateRange" class="w-full border border-border rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary">
                                <option value="30">Last 30 days</option>
                                <option value="90" selected>Last 90 days</option>
                                <option value="180">Last 6 months</option>
                                <option value="365">Last year</option>
                            </select>
                        </div>

                        <!-- Site Grouping -->
                        <div class="mb-6">
                            <label class="block text-sm font-medium text-text-primary mb-2">Site Grouping</label>
                            <div class="space-y-2">
                                <label class="flex items-center">
                                    <input type="checkbox" checked class="rounded border-border text-primary focus:ring-primary">
                                    <span class="ml-2 text-sm text-text-secondary">All Sites</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="rounded border-border text-primary focus:ring-primary">
                                    <span class="ml-2 text-sm text-text-secondary">Manufacturing</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="rounded border-border text-primary focus:ring-primary">
                                    <span class="ml-2 text-sm text-text-secondary">Warehouses</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="rounded border-border text-primary focus:ring-primary">
                                    <span class="ml-2 text-sm text-text-secondary">Offices</span>
                                </label>
                            </div>
                        </div>

                        <!-- Metric Customization -->
                        <div class="mb-6">
                            <label class="block text-sm font-medium text-text-primary mb-2">Metrics</label>
                            <div class="space-y-2">
                                <label class="flex items-center">
                                    <input type="checkbox" checked class="rounded border-border text-primary focus:ring-primary">
                                    <span class="ml-2 text-sm text-text-secondary">Incidents</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" checked class="rounded border-border text-primary focus:ring-primary">
                                    <span class="ml-2 text-sm text-text-secondary">Near Misses</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="rounded border-border text-primary focus:ring-primary">
                                    <span class="ml-2 text-sm text-text-secondary">Cost Impact</span>
                                </label>
                            </div>
                        </div>

                        <!-- Quick Actions -->
                        <div class="space-y-2">
                            <button onclick="resetFilters()" class="w-full btn-secondary text-sm py-2">
                                Reset Filters
                            </button>
                            <button onclick="saveView()" class="w-full text-primary hover:text-primary-700 text-sm py-2 border border-primary rounded-md">
                                Save View
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Main Visualization Area (60%) -->
                <div class="lg:col-span-3">
                    <div class="space-y-6">
                        <!-- Chart Navigation Tabs -->
                        <div class="card p-4">
                            <div class="flex flex-wrap gap-2">
                                <button onclick="switchChart('trends')" id="trendsTab" class="px-4 py-2 text-sm font-medium bg-primary text-white rounded-md">
                                    1. Trends
                                </button>
                                <button onclick="switchChart('severity')" id="severityTab" class="px-4 py-2 text-sm font-medium text-text-secondary hover:text-primary rounded-md">
                                    2. Severity
                                </button>
                                <button onclick="switchChart('sites')" id="sitesTab" class="px-4 py-2 text-sm font-medium text-text-secondary hover:text-primary rounded-md">
                                    3. Top Sites
                                </button>
                                <button onclick="switchChart('predictive')" id="predictiveTab" class="px-4 py-2 text-sm font-medium text-text-secondary hover:text-primary rounded-md">
                                    4. Predictive
                                </button>
                            </div>
                        </div>

                        <!-- Monthly Incident Trends Chart -->
                        <div id="trendsChart" class="card p-6">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold text-text-primary">Monthly Incident Trends</h3>
                                <button onclick="drillDown('trends')" class="text-primary hover:text-primary-700 text-sm font-medium">
                                    Drill Down →
                                </button>
                            </div>
                            
                            <!-- Chart Placeholder with SVG -->
                            <div class="relative h-80 bg-gray-50 rounded-lg border border-border overflow-hidden">
                                <svg class="w-full h-full" viewBox="0 0 800 320">
                                    <!-- Grid Lines -->
                                    <defs>
                                        <pattern id="grid" width="80" height="32" patternUnits="userSpaceOnUse">
                                            <path d="M 80 0 L 0 0 0 32" fill="none" stroke="#E0E0E0" stroke-width="1"/>
                                        </pattern>
                                    </defs>
                                    <rect width="100%" height="100%" fill="url(#grid)"/>
                                    
                                    <!-- Trend Line -->
                                    <polyline fill="none" stroke="#4CAF50" stroke-width="3" 
                                              points="80,280 160,240 240,200 320,180 400,160 480,140 560,120 640,100 720,80"/>
                                    
                                    <!-- Data Points -->
                                    <circle cx="80" cy="280" r="4" fill="#4CAF50"/>
                                    <circle cx="160" cy="240" r="4" fill="#4CAF50"/>
                                    <circle cx="240" cy="200" r="4" fill="#4CAF50"/>
                                    <circle cx="320" cy="180" r="4" fill="#4CAF50"/>
                                    <circle cx="400" cy="160" r="4" fill="#4CAF50"/>
                                    <circle cx="480" cy="140" r="4" fill="#4CAF50"/>
                                    <circle cx="560" cy="120" r="4" fill="#4CAF50"/>
                                    <circle cx="640" cy="100" r="4" fill="#4CAF50"/>
                                    <circle cx="720" cy="80" r="4" fill="#4CAF50"/>
                                    
                                    <!-- Labels -->
                                    <text x="80" y="310" text-anchor="middle" class="text-xs fill-current text-text-secondary">Jan</text>
                                    <text x="240" y="310" text-anchor="middle" class="text-xs fill-current text-text-secondary">Mar</text>
                                    <text x="400" y="310" text-anchor="middle" class="text-xs fill-current text-text-secondary">May</text>
                                    <text x="560" y="310" text-anchor="middle" class="text-xs fill-current text-text-secondary">Jul</text>
                                    <text x="720" y="310" text-anchor="middle" class="text-xs fill-current text-text-secondary">Sep</text>
                                </svg>
                                
                                <!-- Hover Tooltip -->
                                <div class="absolute top-4 left-4 bg-surface shadow-md rounded-lg p-3 opacity-0 transition-opacity" id="trendTooltip">
                                    <p class="text-sm font-medium text-text-primary">September 2025</p>
                                    <p class="text-xs text-text-secondary">12 incidents (-15% from Aug)</p>
                                </div>
                            </div>
                            
                            <!-- Chart Legend -->
                            <div class="flex items-center justify-center space-x-6 mt-4 text-sm">
                                <div class="flex items-center">
                                    <div class="w-3 h-3 bg-success rounded-full mr-2"></div>
                                    <span class="text-text-secondary">Total Incidents</span>
                                </div>
                                <div class="flex items-center">
                                    <div class="w-3 h-3 bg-warning rounded-full mr-2"></div>
                                    <span class="text-text-secondary">High Severity</span>
                                </div>
                                <div class="flex items-center">
                                    <div class="w-3 h-3 bg-primary rounded-full mr-2"></div>
                                    <span class="text-text-secondary">Trend Line</span>
                                </div>
                            </div>
                        </div>

                        <!-- Severity Distribution Chart (Hidden by default) -->
                        <div id="severityChart" class="card p-6 hidden">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold text-text-primary">Severity Distribution</h3>
                                <button onclick="drillDown('severity')" class="text-primary hover:text-primary-700 text-sm font-medium">
                                    View Details →
                                </button>
                            </div>
                            
                            <!-- Pie Chart Placeholder -->
                            <div class="relative h-80 bg-gray-50 rounded-lg border border-border flex items-center justify-center">
                                <svg class="w-64 h-64" viewBox="0 0 200 200">
                                    <!-- Pie Slices -->
                                    <circle cx="100" cy="100" r="80" fill="#4CAF50" stroke="white" stroke-width="2" 
                                            stroke-dasharray="125.6 376.8" stroke-dashoffset="0" transform="rotate(-90 100 100)"/>
                                    <circle cx="100" cy="100" r="80" fill="#FFC107" stroke="white" stroke-width="2" 
                                            stroke-dasharray="75.4 426.6" stroke-dashoffset="-125.6" transform="rotate(-90 100 100)"/>
                                    <circle cx="100" cy="100" r="80" fill="#F44336" stroke="white" stroke-width="2" 
                                            stroke-dasharray="50.2 451.8" stroke-dashoffset="-201" transform="rotate(-90 100 100)"/>
                                    
                                    <!-- Center Text -->
                                    <text x="100" y="95" text-anchor="middle" class="text-lg font-semibold fill-current text-text-primary">149</text>
                                    <text x="100" y="110" text-anchor="middle" class="text-sm fill-current text-text-secondary">Total</text>
                                </svg>
                            </div>
                            
                            <!-- Severity Legend -->
                            <div class="grid grid-cols-3 gap-4 mt-6">
                                <div class="text-center">
                                    <div class="w-4 h-4 bg-success rounded-full mx-auto mb-1"></div>
                                    <p class="text-sm font-medium text-text-primary">Low</p>
                                    <p class="text-xs text-text-secondary">89 incidents (60%)</p>
                                </div>
                                <div class="text-center">
                                    <div class="w-4 h-4 bg-warning rounded-full mx-auto mb-1"></div>
                                    <p class="text-sm font-medium text-text-primary">Medium</p>
                                    <p class="text-xs text-text-secondary">42 incidents (28%)</p>
                                </div>
                                <div class="text-center">
                                    <div class="w-4 h-4 bg-error rounded-full mx-auto mb-1"></div>
                                    <p class="text-sm font-medium text-text-primary">High</p>
                                    <p class="text-xs text-text-secondary">18 incidents (12%)</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- KPI Panel (20%) -->
                <div class="lg:col-span-1">
                    <div class="space-y-6">
                        <!-- Key Performance Indicators -->
                        <div class="card p-6">
                            <h3 class="text-lg font-semibold text-text-primary mb-4">Key Metrics</h3>
                            
                            <!-- Incident Rate -->
                            <div class="mb-6">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-sm font-medium text-text-primary">Incident Rate</span>
                                    <span class="text-sm text-success">-12%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-success h-2 rounded-full" style="width: 75%"></div>
                                </div>
                                <div class="flex justify-between text-xs text-text-secondary mt-1">
                                    <span>Current: 2.3</span>
                                    <span>Target: 2.0</span>
                                </div>
                            </div>

                            <!-- Response Time -->
                            <div class="mb-6">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-sm font-medium text-text-primary">Avg Response</span>
                                    <span class="text-sm text-success">-8%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-primary h-2 rounded-full" style="width: 85%"></div>
                                </div>
                                <div class="flex justify-between text-xs text-text-secondary mt-1">
                                    <span>Current: 18min</span>
                                    <span>Target: 15min</span>
                                </div>
                            </div>

                            <!-- Compliance Score -->
                            <div class="mb-6">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-sm font-medium text-text-primary">Compliance</span>
                                    <span class="text-sm text-success">+3%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-success h-2 rounded-full" style="width: 92%"></div>
                                </div>
                                <div class="flex justify-between text-xs text-text-secondary mt-1">
                                    <span>Current: 92%</span>
                                    <span>Target: 95%</span>
                                </div>
                            </div>

                            <!-- Alert Threshold -->
                            <div class="p-3 bg-warning-50 rounded-lg border-l-4 border-warning">
                                <div class="flex items-center">
                                    <svg class="w-4 h-4 text-warning mr-2" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
                                    </svg>
                                    <div>
                                        <p class="text-sm font-medium text-warning">Threshold Alert</p>
                                        <p class="text-xs text-text-secondary">Site B-07 approaching limit</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Top Unsafe Sites -->
                        <div class="card p-6">
                            <h3 class="text-lg font-semibold text-text-primary mb-4">Top Risk Sites</h3>
                            
                            <div class="space-y-4">
                                <div class="flex items-center justify-between p-3 bg-error-50 rounded-lg">
                                    <div>
                                        <p class="text-sm font-medium text-text-primary">Site A-12</p>
                                        <p class="text-xs text-text-secondary">Manufacturing</p>
                                    </div>
                                    <div class="text-right">
                                        <p class="text-sm font-bold text-error">23</p>
                                        <p class="text-xs text-text-secondary">incidents</p>
                                    </div>
                                </div>

                                <div class="flex items-center justify-between p-3 bg-warning-50 rounded-lg">
                                    <div>
                                        <p class="text-sm font-medium text-text-primary">Site C-08</p>
                                        <p class="text-xs text-text-secondary">Warehouse</p>
                                    </div>
                                    <div class="text-right">
                                        <p class="text-sm font-bold text-warning">18</p>
                                        <p class="text-xs text-text-secondary">incidents</p>
                                    </div>
                                </div>

                                <div class="flex items-center justify-between p-3 bg-primary-50 rounded-lg">
                                    <div>
                                        <p class="text-sm font-medium text-text-primary">Site B-05</p>
                                        <p class="text-xs text-text-secondary">Office</p>
                                    </div>
                                    <div class="text-right">
                                        <p class="text-sm font-bold text-primary">12</p>
                                        <p class="text-xs text-text-secondary">incidents</p>
                                    </div>
                                </div>
                            </div>

                            <button onclick="window.location.href='safety_reports_management.html'" 
                                    class="w-full mt-4 text-primary hover:text-primary-700 text-sm font-medium py-2 border border-primary rounded-md">
                                View All Sites
                            </button>
                        </div>

                        <!-- Quick Export -->
                        <div class="card p-6">
                            <h3 class="text-lg font-semibold text-text-primary mb-4">Quick Export</h3>
                            
                            <div class="space-y-3">
                                <button onclick="exportData('osha')" class="w-full btn-primary text-sm py-2">
                                    <svg class="w-4 h-4 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                    </svg>
                                    OSHA Report
                                </button>
                                
                                <button onclick="exportData('executive')" class="w-full btn-secondary text-sm py-2">
                                    <svg class="w-4 h-4 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                                    </svg>
                                    Executive Summary
                                </button>
                                
                                <button onclick="exportData('csv')" class="w-full text-text-secondary hover:text-primary text-sm py-2 border border-border rounded-md">
                                    <svg class="w-4 h-4 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                    </svg>
                                    Raw Data (CSV)
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mobile Layout -->
            <div class="lg:hidden space-y-6">
                <!-- Mobile Summary Cards -->
                <div class="grid grid-cols-2 gap-4">
                    <div class="card p-4 text-center">
                        <p class="text-2xl font-bold text-text-primary">149</p>
                        <p class="text-sm text-text-secondary">Total Incidents</p>
                        <p class="text-xs text-success mt-1">-12% vs last period</p>
                    </div>
                    <div class="card p-4 text-center">
                        <p class="text-2xl font-bold text-text-primary">92%</p>
                        <p class="text-sm text-text-secondary">Compliance</p>
                        <p class="text-xs text-success mt-1">+3% improvement</p>
                    </div>
                </div>

                <!-- Mobile Chart -->
                <div class="card p-6">
                    <h3 class="text-lg font-semibold text-text-primary mb-4">Incident Trends</h3>
                    <div class="h-48 bg-gray-50 rounded-lg border border-border flex items-center justify-center">
                        <div class="text-center">
                            <svg class="w-12 h-12 text-gray-400 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                            </svg>
                            <p class="text-gray-500 text-sm">Interactive Chart</p>
                            <p class="text-gray-400 text-xs">Tap for full view</p>
                        </div>
                    </div>
                </div>

                <!-- Mobile Quick Actions -->
                <div class="grid grid-cols-2 gap-4">
                    <button onclick="window.location.href='safety_reports_management.html'" 
                            class="card p-4 text-center hover:shadow-card-hover transition-smooth">
                        <svg class="w-8 h-8 text-primary mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                        </svg>
                        <p class="text-sm font-medium text-text-primary">View Reports</p>
                    </button>
                    
                    <button onclick="exportData('executive')" 
                            class="card p-4 text-center hover:shadow-card-hover transition-smooth">
                        <svg class="w-8 h-8 text-secondary mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                        </svg>
                        <p class="text-sm font-medium text-text-primary">Export Data</p>
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Fixed Bottom Navigation -->
    <nav class="fixed bottom-0 left-0 right-0 bg-surface border-t border-border z-40">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex items-center justify-around h-16">
                <a href="ho_safety_dashboard.html" class="flex flex-col items-center space-y-1 text-text-secondary hover:text-primary transition-micro">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/>
                    </svg>
                    <span class="text-xs font-medium">Dashboard</span>
                </a>
                <a href="safety_reports_management.html" class="flex flex-col items-center space-y-1 text-text-secondary hover:text-primary transition-micro">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                    </svg>
                    <span class="text-xs font-medium">Reports</span>
                </a>
                <a href="team_management_interface.html" class="flex flex-col items-center space-y-1 text-text-secondary hover:text-primary transition-micro">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                    </svg>
                    <span class="text-xs font-medium">Teams</span>
                </a>
                <a href="alert_broadcasting_system.html" class="flex flex-col items-center space-y-1 text-text-secondary hover:text-primary transition-micro">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-5 5v-5z"/>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"/>
                    </svg>
                    <span class="text-xs font-medium">Alerts</span>
                </a>
                <a href="safety_analytics_dashboard.html" class="flex flex-col items-center space-y-1 text-primary">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                    </svg>
                    <span class="text-xs font-medium">Analytics</span>
                </a>
            </div>
        </div>
    </nav>

    <script>
        // Chart switching functionality
        function switchChart(chartType) {
            // Hide all charts
            document.getElementById('trendsChart').classList.add('hidden');
            document.getElementById('severityChart').classList.add('hidden');
            
            // Reset all tab styles
            const tabs = ['trendsTab', 'severityTab', 'sitesTab', 'predictiveTab'];
            tabs.forEach(tab => {
                const element = document.getElementById(tab);
                element.className = 'px-4 py-2 text-sm font-medium text-text-secondary hover:text-primary rounded-md';
            });
            
            // Show selected chart and activate tab
            if (chartType === 'trends') {
                document.getElementById('trendsChart').classList.remove('hidden');
                document.getElementById('trendsTab').className = 'px-4 py-2 text-sm font-medium bg-primary text-white rounded-md';
            } else if (chartType === 'severity') {
                document.getElementById('severityChart').classList.remove('hidden');
                document.getElementById('severityTab').className = 'px-4 py-2 text-sm font-medium bg-primary text-white rounded-md';
            }
        }

        // Keyboard shortcuts for chart switching
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey) {
                switch(e.key) {
                    case 'r':
                        e.preventDefault();
                        window.location.href = 'safety_reports_management.html';
                        break;
                    case 'p':
                        e.preventDefault();
                        exportData('pdf');
                        break;
                    case 'e':
                        e.preventDefault();
                        exportData('executive');
                        break;
                }
            } else {
                switch(e.key) {
                    case '1':
                        e.preventDefault();
                        switchChart('trends');
                        break;
                    case '2':
                        e.preventDefault();
                        switchChart('severity');
                        break;
                    case '3':
                        e.preventDefault();
                        switchChart('sites');
                        break;
                    case '4':
                        e.preventDefault();
                        switchChart('predictive');
                        break;
                }
            }
        });

        // Export functionality
        function exportData(format) {
            const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');
            let filename = '';
            
            switch(format) {
                case 'osha':
                    filename = `OSHA_Safety_Report_${timestamp}.pdf`;
                    break;
                case 'executive':
                    filename = `Executive_Safety_Summary_${timestamp}.pdf`;
                    break;
                case 'csv':
                    filename = `Safety_Data_Export_${timestamp}.csv`;
                    break;
                case 'pdf':
                    filename = `Safety_Analytics_${timestamp}.pdf`;
                    break;
                default:
                    filename = `Safety_Export_${timestamp}.pdf`;
            }
            
            // Simulate download
            alert(`Exporting ${filename}...\n\nThis would normally trigger a download of the ${format.toUpperCase()} report.`);
        }

        // Drill down functionality
        function drillDown(chartType) {
            alert(`Drilling down into ${chartType} data...\n\nThis would navigate to detailed view with context preservation.`);
        }

        // Filter functions
        function resetFilters() {
            document.getElementById('dateRange').value = '90';
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(checkbox => {
                checkbox.checked = checkbox.parentElement.textContent.includes('All Sites') || 
                                 checkbox.parentElement.textContent.includes('Incidents') || 
                                 checkbox.parentElement.textContent.includes('Near Misses');
            });
            alert('Filters reset to default values.');
        }

        function saveView() {
            alert('Current view saved successfully!\n\nYou can access this saved view from your profile settings.');
        }

        // Simulate real-time updates
        function updateData() {
            const syncElement = document.querySelector('.animate-pulse');
            if (syncElement) {
                syncElement.classList.remove('animate-pulse');
                setTimeout(() => {
                    syncElement.classList.add('animate-pulse');
                }, 2000);
            }
        }

        // Update data every 30 seconds
        setInterval(updateData, 30000);

        // Chart hover effects
        document.addEventListener('DOMContentLoaded', function() {
            const chartElements = document.querySelectorAll('circle[cx]');
            chartElements.forEach(element => {
                element.addEventListener('mouseenter', function() {
                    const tooltip = document.getElementById('trendTooltip');
                    if (tooltip) {
                        tooltip.style.opacity = '1';
                    }
                });
                
                element.addEventListener('mouseleave', function() {
                    const tooltip = document.getElementById('trendTooltip');
                    if (tooltip) {
                        tooltip.style.opacity = '0';
                    }
                });
            });

            // Add fade-in animation to cards
            const cards = document.querySelectorAll('.card');
            cards.forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    card.style.transition = 'all 0.3s ease-out';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 100);
            });
        });

        // Print optimization
        window.addEventListener('beforeprint', function() {
            document.body.classList.add('print-mode');
        });

        window.addEventListener('afterprint', function() {
            document.body.classList.remove('print-mode');
        });
    </script>

    <style>
        @media print {
            .print-mode {
                -webkit-print-color-adjust: exact;
                color-adjust: exact;
            }
            
            .fixed {
                position: static !important;
            }
            
            .hidden {
                display: block !important;
            }
            
            .lg\:hidden {
                display: none !important;
            }
            
            .card {
                break-inside: avoid;
                page-break-inside: avoid;
            }
            
            @page {
                margin: 1in;
                @top-center {
                    content: "HO Safety Management - Analytics Report";
                }
                @bottom-center {
                    content: "Generated on " date() " - Page " counter(page);
                }
            }
        }
    </style>
<script id="dhws-dataInjector" src="../public/dhws-data-injector.js"></script>
</body>
</html>