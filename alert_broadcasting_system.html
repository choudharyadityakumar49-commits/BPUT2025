<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alert Broadcasting System - HO Safety Management</title>
    <link rel="stylesheet" href="../css/main.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <script type="module" src="https://static.rocket.new/rocket-web.js?_cfg=https%3A%2F%2Fhosafety6270back.builtwithrocket.new&_be=https%3A%2F%2Fapplication.rocket.new&_v=0.1.9"></script>
  <script type="module" src="https://static.rocket.new/rocket-shot.js?v=0.0.1"></script>
  </head>
<body class="bg-background min-h-screen">
    <!-- Fixed Header -->
    <header class="bg-surface shadow-sm border-b border-border fixed top-0 left-0 right-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <!-- Logo and Title -->
                <div class="flex items-center space-x-3">
                    <div class="flex-shrink-0">
                        <svg class="h-8 w-8 text-primary" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-xl font-semibold text-text-primary">HO Safety Management</h1>
                        <p class="text-sm text-text-secondary">Alert Broadcasting System</p>
                    </div>
                </div>

                <!-- Header Actions -->
                <div class="flex items-center space-x-4">
                    <!-- Quick Actions -->
                    <div class="hidden md:flex items-center space-x-2">
                        <button onclick="createNewAlert()" 
                                class="btn-secondary text-sm px-3 py-2" title="New Alert (Ctrl+N)">
                            <svg class="w-4 h-4 mr-1 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                            </svg>
                            New Alert
                        </button>
                        <button onclick="saveDraft()" 
                                class="btn-primary text-sm px-3 py-2" title="Save Draft (Ctrl+S)">
                            <svg class="w-4 h-4 mr-1 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"/>
                            </svg>
                            Save Draft
                        </button>
                    </div>

                    <!-- Notifications -->
                    <div class="relative">
                        <button class="relative p-2 text-text-secondary hover:text-text-primary transition-micro rounded-lg hover:bg-gray-100">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-5 5v-5z"/>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"/>
                            </svg>
                            <span class="absolute -top-1 -right-1 bg-error text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">3</span>
                        </button>
                    </div>

                    <!-- User Role Indicator -->
                    <div class="flex items-center space-x-2">
                        <div class="hidden sm:block text-right">
                            <p class="text-sm font-medium text-text-primary">Sarah Johnson</p>
                            <p class="text-xs text-text-secondary">Safety Manager</p>
                        </div>
                        <img src="https://images.unsplash.com/photo-1592831383329-23d79a212006" 
                             alt="Sarah Johnson profile picture" 
                             class="h-8 w-8 rounded-full object-cover"
                             onerror="this.src='https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; this.onerror=null;">
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="pt-16 pb-20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <!-- Page Title and Status -->
            <div class="flex items-center justify-between mb-6">
                <div>
                    <h2 class="text-2xl font-semibold text-text-primary">Alert Broadcasting System</h2>
                    <p class="text-text-secondary mt-1">Rapid safety communication distribution across all sites</p>
                </div>
                <div class="flex items-center space-x-2 text-sm text-success">
                    <div class="w-2 h-2 bg-success rounded-full animate-pulse"></div>
                    <span>Broadcasting active</span>
                    <span class="text-text-secondary">â€¢ 24 recipients online</span>
                </div>
            </div>

            <!-- Desktop Layout: Composition (40%) + History (60%) -->
            <div class="grid grid-cols-1 lg:grid-cols-5 gap-6">
                <!-- Alert Composition Panel -->
                <div class="lg:col-span-2">
                    <div class="card p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-lg font-semibold text-text-primary">Compose Alert</h3>
                            <div class="flex items-center space-x-2">
                                <button onclick="loadTemplate()" class="text-primary hover:text-primary-700 text-sm font-medium">
                                    Templates
                                </button>
                                <button onclick="clearForm()" class="text-text-secondary hover:text-text-primary text-sm">
                                    Clear
                                </button>
                            </div>
                        </div>

                        <form id="alertForm" class="space-y-6">
                            <!-- Alert Title -->
                            <div>
                                <label for="alertTitle" class="block text-sm font-medium text-text-primary mb-2">
                                    Alert Title *
                                </label>
                                <input type="text" 
                                       id="alertTitle" 
                                       name="alertTitle"
                                       placeholder="Enter alert title..."
                                       class="w-full px-3 py-2 border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                                       required>
                            </div>

                            <!-- Priority Level -->
                            <div>
                                <label for="priority" class="block text-sm font-medium text-text-primary mb-2">
                                    Priority Level *
                                </label>
                                <select id="priority" 
                                        name="priority"
                                        class="w-full px-3 py-2 border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                                        required>
                                    <option value="">Select priority...</option>
                                    <option value="critical">ðŸ”´ Critical - Emergency</option>
                                    <option value="high">ðŸŸ  High - Urgent Action Required</option>
                                    <option value="medium">ðŸŸ¡ Medium - Important Notice</option>
                                    <option value="low">ðŸŸ¢ Low - General Information</option>
                                </select>
                            </div>

                            <!-- Target Audience -->
                            <div>
                                <label class="block text-sm font-medium text-text-primary mb-2">
                                    Target Audience *
                                </label>
                                <div class="space-y-2 max-h-32 overflow-y-auto border border-border rounded-md p-3">
                                    <label class="flex items-center">
                                        <input type="checkbox" name="audience" value="all" class="mr-2 text-primary focus:ring-primary">
                                        <span class="text-sm">All Sites & Supervisors</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="audience" value="supervisors" class="mr-2 text-primary focus:ring-primary">
                                        <span class="text-sm">Site Supervisors Only</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="audience" value="managers" class="mr-2 text-primary focus:ring-primary">
                                        <span class="text-sm">Safety Managers</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="audience" value="site-a" class="mr-2 text-primary focus:ring-primary">
                                        <span class="text-sm">Site A Team</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="audience" value="site-b" class="mr-2 text-primary focus:ring-primary">
                                        <span class="text-sm">Site B Team</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="audience" value="site-c" class="mr-2 text-primary focus:ring-primary">
                                        <span class="text-sm">Site C Team</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Message Content -->
                            <div>
                                <label for="message" class="block text-sm font-medium text-text-primary mb-2">
                                    Message Content *
                                </label>
                                <textarea id="message" 
                                          name="message"
                                          rows="6"
                                          placeholder="Enter your safety alert message..."
                                          class="w-full px-3 py-2 border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent resize-none"
                                          required></textarea>
                                <div class="flex items-center justify-between mt-2">
                                    <span class="text-xs text-text-secondary">Character count: <span id="charCount">0</span>/500</span>
                                    <button type="button" onclick="insertTemplate()" class="text-xs text-primary hover:text-primary-700">
                                        Insert Template
                                    </button>
                                </div>
                            </div>

                            <!-- Delivery Methods -->
                            <div>
                                <label class="block text-sm font-medium text-text-primary mb-2">
                                    Delivery Methods *
                                </label>
                                <div class="flex flex-wrap gap-3">
                                    <label class="flex items-center">
                                        <input type="checkbox" name="delivery" value="push" class="mr-2 text-primary focus:ring-primary" checked>
                                        <span class="text-sm">ðŸ“± Mobile Push</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="delivery" value="email" class="mr-2 text-primary focus:ring-primary">
                                        <span class="text-sm">ðŸ“§ Email</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="delivery" value="sms" class="mr-2 text-primary focus:ring-primary">
                                        <span class="text-sm">ðŸ“± SMS</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Scheduling Options -->
                            <div>
                                <label class="block text-sm font-medium text-text-primary mb-2">
                                    Delivery Schedule
                                </label>
                                <div class="space-y-3">
                                    <label class="flex items-center">
                                        <input type="radio" name="schedule" value="immediate" class="mr-2 text-primary focus:ring-primary" checked>
                                        <span class="text-sm">Send Immediately</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="radio" name="schedule" value="scheduled" class="mr-2 text-primary focus:ring-primary">
                                        <span class="text-sm">Schedule for Later</span>
                                    </label>
                                    <div id="scheduleOptions" class="ml-6 hidden">
                                        <input type="datetime-local" 
                                               name="scheduleTime"
                                               class="px-3 py-2 border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-sm">
                                    </div>
                                </div>
                            </div>

                            <!-- Action Buttons -->
                            <div class="flex flex-col sm:flex-row gap-3 pt-4 border-t border-border">
                                <button type="submit" class="btn-primary flex-1">
                                    <svg class="w-4 h-4 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
                                    </svg>
                                    Send Alert
                                </button>
                                <button type="button" onclick="saveDraft()" class="btn-secondary flex-1">
                                    <svg class="w-4 h-4 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"/>
                                    </svg>
                                    Save Draft
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Alert History & Tracking Panel -->
                <div class="lg:col-span-3">
                    <div class="card p-6">
                        <div class="flex items-center justify-between mb-6">
                            <div>
                                <h3 class="text-lg font-semibold text-text-primary">Alert History & Tracking</h3>
                                <p class="text-text-secondary text-sm">Recent communications and delivery status</p>
                            </div>
                            <div class="flex items-center space-x-2">
                                <button onclick="exportLogs()" class="text-primary hover:text-primary-700 text-sm font-medium">
                                    Export Logs
                                </button>
                                <button onclick="refreshHistory()" class="text-text-secondary hover:text-text-primary">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <!-- Filter Bar -->
                        <div class="flex flex-col sm:flex-row gap-3 mb-6 p-4 bg-gray-50 rounded-lg">
                            <select class="px-3 py-2 border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-sm">
                                <option>All Priorities</option>
                                <option>Critical</option>
                                <option>High</option>
                                <option>Medium</option>
                                <option>Low</option>
                            </select>
                            <select class="px-3 py-2 border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-sm">
                                <option>All Status</option>
                                <option>Delivered</option>
                                <option>Pending</option>
                                <option>Failed</option>
                                <option>Acknowledged</option>
                            </select>
                            <input type="date" 
                                   class="px-3 py-2 border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary text-sm">
                            <button class="btn-secondary text-sm px-4 py-2">
                                <svg class="w-4 h-4 mr-1 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"/>
                                </svg>
                                Filter
                            </button>
                        </div>

                        <!-- Alert History Table -->
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead class="bg-gray-50 border-b border-border">
                                    <tr>
                                        <th class="text-left py-3 px-4 font-medium text-text-primary">Alert</th>
                                        <th class="text-left py-3 px-4 font-medium text-text-primary">Priority</th>
                                        <th class="text-left py-3 px-4 font-medium text-text-primary">Recipients</th>
                                        <th class="text-left py-3 px-4 font-medium text-text-primary">Status</th>
                                        <th class="text-left py-3 px-4 font-medium text-text-primary">Sent</th>
                                        <th class="text-left py-3 px-4 font-medium text-text-primary">Actions</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-border">
                                    <!-- Alert 1 -->
                                    <tr class="hover:bg-gray-50 transition-micro">
                                        <td class="py-4 px-4">
                                            <div>
                                                <p class="font-medium text-text-primary">Equipment Malfunction - Site A-12</p>
                                                <p class="text-xs text-text-secondary mt-1">Immediate safety protocol activation required</p>
                                            </div>
                                        </td>
                                        <td class="py-4 px-4">
                                            <span class="status-indicator status-error text-xs">CRITICAL</span>
                                        </td>
                                        <td class="py-4 px-4">
                                            <div class="flex items-center">
                                                <span class="text-text-primary font-medium">18</span>
                                                <div class="ml-2 flex -space-x-1">
                                                    <div class="w-6 h-6 bg-success rounded-full border-2 border-white flex items-center justify-center">
                                                        <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20">
                                                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                                                        </svg>
                                                    </div>
                                                    <div class="w-6 h-6 bg-warning rounded-full border-2 border-white flex items-center justify-center">
                                                        <span class="text-xs text-white font-bold">2</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="py-4 px-4">
                                            <div class="flex items-center">
                                                <div class="w-2 h-2 bg-success rounded-full mr-2"></div>
                                                <span class="text-success text-sm font-medium">Delivered</span>
                                            </div>
                                            <p class="text-xs text-text-secondary">16/18 acknowledged</p>
                                        </td>
                                        <td class="py-4 px-4">
                                            <p class="text-text-primary">Oct 21, 2025</p>
                                            <p class="text-xs text-text-secondary">1:45 PM</p>
                                        </td>
                                        <td class="py-4 px-4">
                                            <div class="flex items-center space-x-2">
                                                <button onclick="viewDetails('alert-1')" class="text-primary hover:text-primary-700 text-xs">
                                                    View
                                                </button>
                                                <button onclick="resendAlert('alert-1')" class="text-text-secondary hover:text-text-primary text-xs">
                                                    Resend
                                                </button>
                                            </div>
                                        </td>
                                    </tr>

                                    <!-- Alert 2 -->
                                    <tr class="hover:bg-gray-50 transition-micro">
                                        <td class="py-4 px-4">
                                            <div>
                                                <p class="font-medium text-text-primary">Weekly Safety Training Reminder</p>
                                                <p class="text-xs text-text-secondary mt-1">Mandatory training session scheduled for tomorrow</p>
                                            </div>
                                        </td>
                                        <td class="py-4 px-4">
                                            <span class="status-indicator status-warning text-xs">HIGH</span>
                                        </td>
                                        <td class="py-4 px-4">
                                            <div class="flex items-center">
                                                <span class="text-text-primary font-medium">24</span>
                                                <div class="ml-2 flex -space-x-1">
                                                    <div class="w-6 h-6 bg-success rounded-full border-2 border-white flex items-center justify-center">
                                                        <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20">
                                                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                                                        </svg>
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="py-4 px-4">
                                            <div class="flex items-center">
                                                <div class="w-2 h-2 bg-success rounded-full mr-2"></div>
                                                <span class="text-success text-sm font-medium">Delivered</span>
                                            </div>
                                            <p class="text-xs text-text-secondary">24/24 acknowledged</p>
                                        </td>
                                        <td class="py-4 px-4">
                                            <p class="text-text-primary">Oct 20, 2025</p>
                                            <p class="text-xs text-text-secondary">9:30 AM</p>
                                        </td>
                                        <td class="py-4 px-4">
                                            <div class="flex items-center space-x-2">
                                                <button onclick="viewDetails('alert-2')" class="text-primary hover:text-primary-700 text-xs">
                                                    View
                                                </button>
                                                <button onclick="createTemplate('alert-2')" class="text-text-secondary hover:text-text-primary text-xs">
                                                    Template
                                                </button>
                                            </div>
                                        </td>
                                    </tr>

                                    <!-- Alert 3 -->
                                    <tr class="hover:bg-gray-50 transition-micro">
                                        <td class="py-4 px-4">
                                            <div>
                                                <p class="font-medium text-text-primary">Weather Alert - High Winds Expected</p>
                                                <p class="text-xs text-text-secondary mt-1">Outdoor operations may be affected tomorrow</p>
                                            </div>
                                        </td>
                                        <td class="py-4 px-4">
                                            <span class="status-indicator bg-primary-100 text-primary text-xs">MEDIUM</span>
                                        </td>
                                        <td class="py-4 px-4">
                                            <div class="flex items-center">
                                                <span class="text-text-primary font-medium">12</span>
                                                <div class="ml-2 flex -space-x-1">
                                                    <div class="w-6 h-6 bg-warning rounded-full border-2 border-white flex items-center justify-center">
                                                        <svg class="w-3 h-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                                        </svg>
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="py-4 px-4">
                                            <div class="flex items-center">
                                                <div class="w-2 h-2 bg-warning rounded-full mr-2 animate-pulse"></div>
                                                <span class="text-warning text-sm font-medium">Pending</span>
                                            </div>
                                            <p class="text-xs text-text-secondary">8/12 delivered</p>
                                        </td>
                                        <td class="py-4 px-4">
                                            <p class="text-text-primary">Oct 21, 2025</p>
                                            <p class="text-xs text-text-secondary">2:15 PM</p>
                                        </td>
                                        <td class="py-4 px-4">
                                            <div class="flex items-center space-x-2">
                                                <button onclick="viewDetails('alert-3')" class="text-primary hover:text-primary-700 text-xs">
                                                    View
                                                </button>
                                                <button onclick="cancelAlert('alert-3')" class="text-error hover:text-error-700 text-xs">
                                                    Cancel
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Pagination -->
                        <div class="flex items-center justify-between mt-6 pt-4 border-t border-border">
                            <p class="text-sm text-text-secondary">Showing 1-3 of 47 alerts</p>
                            <div class="flex items-center space-x-2">
                                <button class="px-3 py-1 border border-border rounded text-sm text-text-secondary hover:bg-gray-50">
                                    Previous
                                </button>
                                <button class="px-3 py-1 bg-primary text-white rounded text-sm">1</button>
                                <button class="px-3 py-1 border border-border rounded text-sm text-text-secondary hover:bg-gray-50">2</button>
                                <button class="px-3 py-1 border border-border rounded text-sm text-text-secondary hover:bg-gray-50">3</button>
                                <button class="px-3 py-1 border border-border rounded text-sm text-text-secondary hover:bg-gray-50">
                                    Next
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Templates Section -->
            <div class="mt-8">
                <div class="card p-6">
                    <h3 class="text-lg font-semibold text-text-primary mb-4">Quick Templates</h3>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                        <button onclick="loadTemplate('emergency')" 
                                class="flex items-center p-4 border border-border rounded-lg hover:bg-gray-50 transition-micro text-left">
                            <div class="bg-error-100 p-2 rounded-lg mr-3">
                                <svg class="w-5 h-5 text-error" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"/>
                                </svg>
                            </div>
                            <div>
                                <p class="font-medium text-text-primary">Emergency Alert</p>
                                <p class="text-sm text-text-secondary">Critical incident response</p>
                            </div>
                        </button>

                        <button onclick="loadTemplate('weather')" 
                                class="flex items-center p-4 border border-border rounded-lg hover:bg-gray-50 transition-micro text-left">
                            <div class="bg-warning-100 p-2 rounded-lg mr-3">
                                <svg class="w-5 h-5 text-warning" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"/>
                                </svg>
                            </div>
                            <div>
                                <p class="font-medium text-text-primary">Weather Alert</p>
                                <p class="text-sm text-text-secondary">Weather-related warnings</p>
                            </div>
                        </button>

                        <button onclick="loadTemplate('training')" 
                                class="flex items-center p-4 border border-border rounded-lg hover:bg-gray-50 transition-micro text-left">
                            <div class="bg-primary-100 p-2 rounded-lg mr-3">
                                <svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
                                </svg>
                            </div>
                            <div>
                                <p class="font-medium text-text-primary">Training Reminder</p>
                                <p class="text-sm text-text-secondary">Safety training notifications</p>
                            </div>
                        </button>

                        <button onclick="loadTemplate('maintenance')" 
                                class="flex items-center p-4 border border-border rounded-lg hover:bg-gray-50 transition-micro text-left">
                            <div class="bg-secondary-100 p-2 rounded-lg mr-3">
                                <svg class="w-5 h-5 text-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                                </svg>
                            </div>
                            <div>
                                <p class="font-medium text-text-primary">Maintenance Notice</p>
                                <p class="text-sm text-text-secondary">Equipment maintenance alerts</p>
                            </div>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Fixed Bottom Navigation -->
    <nav class="fixed bottom-0 left-0 right-0 bg-surface border-t border-border z-40">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex items-center justify-around h-16">
                <a href="ho_safety_dashboard.html" class="flex flex-col items-center space-y-1 text-text-secondary hover:text-primary transition-micro">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/>
                    </svg>
                    <span class="text-xs font-medium">Dashboard</span>
                </a>
                <a href="safety_reports_management.html" class="flex flex-col items-center space-y-1 text-text-secondary hover:text-primary transition-micro">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                    </svg>
                    <span class="text-xs font-medium">Reports</span>
                </a>
                <a href="team_management_interface.html" class="flex flex-col items-center space-y-1 text-text-secondary hover:text-primary transition-micro">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                    </svg>
                    <span class="text-xs font-medium">Teams</span>
                </a>
                <a href="alert_broadcasting_system.html" class="flex flex-col items-center space-y-1 text-primary">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M15 17h5l-5 5v-5z"/>
                        <path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"/>
                    </svg>
                    <span class="text-xs font-medium">Alerts</span>
                </a>
                <a href="profile_management_center.html" class="flex flex-col items-center space-y-1 text-text-secondary hover:text-primary transition-micro">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                    </svg>
                    <span class="text-xs font-medium">Profile</span>
                </a>
            </div>
        </div>
    </nav>

    <script>
        // Character counter for message textarea
        const messageTextarea = document.getElementById('message');
        const charCount = document.getElementById('charCount');
        
        messageTextarea.addEventListener('input', function() {
            const count = this.value.length;
            charCount.textContent = count;
            
            if (count > 500) {
                charCount.classList.add('text-error');
            } else {
                charCount.classList.remove('text-error');
            }
        });

        // Schedule options toggle
        const scheduleRadios = document.querySelectorAll('input[name="schedule"]');
        const scheduleOptions = document.getElementById('scheduleOptions');
        
        scheduleRadios.forEach(radio => {
            radio.addEventListener('change', function() {
                if (this.value === 'scheduled') {
                    scheduleOptions.classList.remove('hidden');
                } else {
                    scheduleOptions.classList.add('hidden');
                }
            });
        });

        // Form submission
        document.getElementById('alertForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const alertData = {
                title: formData.get('alertTitle'),
                priority: formData.get('priority'),
                message: formData.get('message'),
                audience: formData.getAll('audience'),
                delivery: formData.getAll('delivery'),
                schedule: formData.get('schedule'),
                scheduleTime: formData.get('scheduleTime'),
                timestamp: new Date().toISOString()
            };
            
            // Validation
            if (!alertData.title || !alertData.priority || !alertData.message) {
                alert('Please fill in all required fields.');
                return;
            }
            
            if (alertData.audience.length === 0) {
                alert('Please select at least one target audience.');
                return;
            }
            
            if (alertData.delivery.length === 0) {
                alert('Please select at least one delivery method.');
                return;
            }
            
            // Simulate sending alert
            const sendButton = this.querySelector('button[type="submit"]');
            const originalText = sendButton.innerHTML;
            
            sendButton.innerHTML = '<svg class="w-4 h-4 mr-2 inline animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/></svg>Sending...';
            sendButton.disabled = true;
            
            setTimeout(() => {
                sendButton.innerHTML = originalText;
                sendButton.disabled = false;
                
                // Show success message
                const successDiv = document.createElement('div');
                successDiv.className = 'fixed top-20 right-4 bg-success text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-fade-in';
                successDiv.innerHTML = `
                    <div class="flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                        </svg>
                        Alert sent successfully!
                    </div>
                `;
                document.body.appendChild(successDiv);
                
                setTimeout(() => {
                    successDiv.remove();
                }, 3000);
                
                // Clear form
                this.reset();
                charCount.textContent = '0';
                scheduleOptions.classList.add('hidden');
                
                // Refresh history (simulate)
                refreshHistory();
            }, 2000);
        });

        // Template functions
        const templates = {
            emergency: {
                title: 'EMERGENCY: Immediate Action Required',
                priority: 'critical',
                message: 'EMERGENCY ALERT: A critical safety incident has occurred. All personnel must follow emergency protocols immediately. Report to designated safety areas and await further instructions. Do not enter restricted zones until all-clear is given.',
                audience: ['all'],
                delivery: ['push', 'sms', 'email']
            },
            weather: {
                title: 'Weather Alert: Severe Conditions Expected',
                priority: 'high',
                message: 'WEATHER ALERT: Severe weather conditions are expected in the next 24 hours. Outdoor operations may be suspended. Please monitor weather updates and follow site-specific safety protocols for adverse weather conditions.',
                audience: ['supervisors'],
                delivery: ['push', 'email']
            },
            training: {
                title: 'Safety Training Reminder',
                priority: 'medium',
                message: 'TRAINING REMINDER: Mandatory safety training session is scheduled. Please ensure all team members attend. Training covers updated safety protocols and emergency procedures. Attendance will be recorded for compliance purposes.',
                audience: ['all'],
                delivery: ['push', 'email']
            },
            maintenance: {
                title: 'Equipment Maintenance Notice',
                priority: 'medium',
                message: 'MAINTENANCE NOTICE: Scheduled equipment maintenance will affect operations. Please follow alternative procedures during maintenance window. Equipment will be offline from [START TIME] to [END TIME]. Contact maintenance team for urgent issues.',
                audience: ['supervisors'],
                delivery: ['push']
            }
        };

        function loadTemplate(type) {
            if (!type || !templates[type]) return;
            
            const template = templates[type];
            const form = document.getElementById('alertForm');
            
            // Fill form fields
            form.alertTitle.value = template.title;
            form.priority.value = template.priority;
            form.message.value = template.message;
            
            // Update character count
            charCount.textContent = template.message.length;
            
            // Check audience checkboxes
            const audienceCheckboxes = form.querySelectorAll('input[name="audience"]');
            audienceCheckboxes.forEach(checkbox => {
                checkbox.checked = template.audience.includes(checkbox.value);
            });
            
            // Check delivery checkboxes
            const deliveryCheckboxes = form.querySelectorAll('input[name="delivery"]');
            deliveryCheckboxes.forEach(checkbox => {
                checkbox.checked = template.delivery.includes(checkbox.value);
            });
        }

        function insertTemplate() {
            const message = document.getElementById('message');
            const templates = [
                '[SITE NAME] - Replace with actual site name',
                '[TIME] - Replace with specific time',
                '[DATE] - Replace with specific date',
                '[CONTACT] - Replace with contact information',
                '[LOCATION] - Replace with specific location'
            ];
            
            const template = templates[Math.floor(Math.random() * templates.length)];
            const cursorPos = message.selectionStart;
            const textBefore = message.value.substring(0, cursorPos);
            const textAfter = message.value.substring(cursorPos);
            
            message.value = textBefore + template + textAfter;
            message.focus();
            message.setSelectionRange(cursorPos + template.length, cursorPos + template.length);
            
            // Update character count
            charCount.textContent = message.value.length;
        }

        function createNewAlert() {
            document.getElementById('alertForm').reset();
            charCount.textContent = '0';
            scheduleOptions.classList.add('hidden');
            document.getElementById('alertTitle').focus();
        }

        function saveDraft() {
            const formData = new FormData(document.getElementById('alertForm'));
            const draftData = {
                title: formData.get('alertTitle'),
                priority: formData.get('priority'),
                message: formData.get('message'),
                audience: formData.getAll('audience'),
                delivery: formData.getAll('delivery'),
                schedule: formData.get('schedule'),
                scheduleTime: formData.get('scheduleTime'),
                savedAt: new Date().toISOString()
            };
            
            // Save to localStorage
            localStorage.setItem('alertDraft', JSON.stringify(draftData));
            
            // Show success message
            const successDiv = document.createElement('div');
            successDiv.className = 'fixed top-20 right-4 bg-primary text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-fade-in';
            successDiv.innerHTML = `
                <div class="flex items-center">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                    </svg>
                    Draft saved successfully!
                </div>
            `;
            document.body.appendChild(successDiv);
            
            setTimeout(() => {
                successDiv.remove();
            }, 3000);
        }

        function clearForm() {
            if (confirm('Are you sure you want to clear the form? Any unsaved changes will be lost.')) {
                document.getElementById('alertForm').reset();
                charCount.textContent = '0';
                scheduleOptions.classList.add('hidden');
            }
        }

        function refreshHistory() {
            // Simulate refresh animation
            const refreshButton = document.querySelector('button[onclick="refreshHistory()"]');
            refreshButton.classList.add('animate-spin');
            
            setTimeout(() => {
                refreshButton.classList.remove('animate-spin');
            }, 1000);
        }

        function exportLogs() {
            // Simulate export functionality
            const exportButton = document.querySelector('button[onclick="exportLogs()"]');
            const originalText = exportButton.textContent;
            
            exportButton.textContent = 'Exporting...';
            exportButton.disabled = true;
            
            setTimeout(() => {
                exportButton.textContent = originalText;
                exportButton.disabled = false;
                
                // Show success message
                const successDiv = document.createElement('div');
                successDiv.className = 'fixed top-20 right-4 bg-success text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-fade-in';
                successDiv.innerHTML = `
                    <div class="flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                        Alert logs exported successfully!
                    </div>
                `;
                document.body.appendChild(successDiv);
                
                setTimeout(() => {
                    successDiv.remove();
                }, 3000);
            }, 2000);
        }

        function viewDetails(alertId) {
            alert(`Viewing details for ${alertId}. This would open a detailed view modal in a real application.`);
        }

        function resendAlert(alertId) {
            if (confirm('Are you sure you want to resend this alert?')) {
                alert(`Resending ${alertId}. This would trigger the resend process in a real application.`);
            }
        }

        function cancelAlert(alertId) {
            if (confirm('Are you sure you want to cancel this alert? This action cannot be undone.')) {
                alert(`Cancelling ${alertId}. This would cancel the pending alert in a real application.`);
            }
        }

        function createTemplate(alertId) {
            if (confirm('Create a template from this alert?')) {
                alert(`Creating template from ${alertId}. This would save the alert as a reusable template.`);
            }
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey) {
                switch(e.key) {
                    case 'n':
                        e.preventDefault();
                        createNewAlert();
                        break;
                    case 's':
                        e.preventDefault();
                        saveDraft();
                        break;
                }
            }
        });

        // Load draft on page load
        document.addEventListener('DOMContentLoaded', function() {
            const savedDraft = localStorage.getItem('alertDraft');
            if (savedDraft) {
                const draftData = JSON.parse(savedDraft);
                const form = document.getElementById('alertForm');
                
                if (draftData.title) form.alertTitle.value = draftData.title;
                if (draftData.priority) form.priority.value = draftData.priority;
                if (draftData.message) {
                    form.message.value = draftData.message;
                    charCount.textContent = draftData.message.length;
                }
                
                
                if (draftData.audience) {
                    draftData.audience.forEach(value => {
                        const checkbox = form.querySelector(`input[name="audience"][value="${value}"]`);
                        if (checkbox) checkbox.checked = true;
                    });
                }
                
                if (draftData.delivery) {
                    draftData.delivery.forEach(value => {
                        const checkbox = form.querySelector(`input[name="delivery"][value="${value}"]`);
                        if (checkbox) checkbox.checked = true;
                    });
                }
                
                if (draftData.schedule) {
                    const radio = form.querySelector(`input[name="schedule"][value="${draftData.schedule}"]`);
                    if (radio) {
                        radio.checked = true;
                        if (draftData.schedule === 'scheduled') {
                            scheduleOptions.classList.remove('hidden');
                            if (draftData.scheduleTime) {
                                form.scheduleTime.value = draftData.scheduleTime;
                            }
                        }
                    }
                }
            }
        });

       
        document.addEventListener('DOMContentLoaded', function() {
            const cards = document.querySelectorAll('.card');
            cards.forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    card.style.transition = 'all 0.3s ease-out';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 100);
            });
        });
    </script>
<script id="dhws-dataInjector" src="../public/dhws-data-injector.js"></script>
</body>
</html>